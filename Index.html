<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Data</title>
    <!-- Include CSS frameworks/libraries for styling -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css">
    <!-- Include custom CSS for additional styling -->
    <style>
        /* Add custom CSS styles here */
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
        }

        .container {
            margin-top: 50px;
        }

        h1 {
            color: #343a40;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: #fff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        th {
            background-color: #343a40;
            color: #fff;
            cursor: pointer;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            margin-bottom: 20px;
            box-sizing: border-box;
        }

        .pagination-button {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 5px;
        }

        .pagination-button:hover {
            background-color: #0056b3;
        }

        /* New styles for table entries */
        tbody tr {
            margin-bottom: 10px;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        tbody tr:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        td {
            padding: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Employee Data</h1>
        <input type="text" id="searchInput" placeholder="Search...">
        <table id="employeeTable" class="table">
            <thead>
                <tr>
                    <th data-sort="id">ID</th>
                    <th data-sort="name">Name</th>
                    <th data-sort="email">Email</th>
                    <th data-sort="phone">Phone Number</th>
                    <!-- Add more columns as needed -->
                </tr>
            </thead>
            <tbody id="employeeTableBody">
                <!-- Table body will be populated dynamically -->
            </tbody>
        </table>
        <div id="pagination" class="pagination"></div>
    </div>

    <!-- Include JavaScript libraries/frameworks -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Include custom JavaScript for fetching data and implementing functionality -->
    <script>
        $(document).ready(function() {
            let employeeData = []; // Array to store employee data
            let currentPage = 1; // Current page
            const recordsPerPage = 6; // Number of records per page
            let currentSortColumn = ''; // Current sort column
            let isAscending = true; // Flag to track sort order

            // Fetch data from the API
            function fetchData() {
                $.ajax({
                    url: 'https://api.findofficers.com/hiring_test/get_all_employee',
                    method: 'GET',
                    success: function(data) {
                        employeeData = data; // Store data in employeeData array
                        renderTable(); // Render table with initial data
                    },
                    error: function(err) {
                        console.error('Error fetching data:', err);
                    }
                });
            }

            // Render table with sorted and paginated data
            function renderTable() {
                // Sort data based on column and order
                let sortedData = sortData(employeeData, currentSortColumn, isAscending);
                
                // Filter data based on search query
                let filteredData = searchFilter(sortedData);
                
                // Calculate total pages
                const totalPages = Math.ceil(filteredData.length / recordsPerPage);
                
                // Paginate data
                let paginatedData = filteredData.slice((currentPage - 1) * recordsPerPage, currentPage * recordsPerPage);

                // Clear existing table rows
                $('#employeeTableBody').empty();

                // Render table rows
                paginatedData.forEach(function(employee) {
                    $('#employeeTableBody').append(`
                        <tr>
                            <td>${employee.employeeID}</td>
                            <td>${employee.firstName} ${employee.lastName}</td>
                            <td>${employee.email}</td>
                            <td>${employee.phoneNumber}</td>
                        </tr>
                    `);
                });

                // Render pagination controls
                renderPagination(totalPages);
            }

            // Sort data based on column and order
            function sortData(data, column, ascending) {
                if (column === '') return data;

                return data.sort((a, b) => {
                    let valA = getColumnValue(a, column);
                    let valB = getColumnValue(b, column);

                    if (typeof valA === 'string') {
                        valA = valA.toUpperCase();
                        valB = valB.toUpperCase();
                    }

                    if (valA < valB) return ascending ? -1 : 1;
                    if (valA > valB) return ascending ? 1 : -1;
                    return 0;
                });
            }

            // Get value of a column from an employee object
            function getColumnValue(employee, column) {
                switch (column) {
                    case 'id':
                        return employee.employeeID;
                    case 'name':
                        return `${employee.firstName} ${employee.lastName}`;
                    case 'email':
                        return employee.email;
                    case 'phone':
                        return employee.phoneNumber;
                    default:
                        return ''; // Return empty string for unknown columns
                }
            }

            // Filter data based on search query
            function searchFilter(data) {
                const searchQuery = $('#searchInput').val().trim().toLowerCase();

                if (searchQuery === '') return data;

                return data.filter(employee => {
                    return (
                        employee.employeeID.toLowerCase().includes(searchQuery) ||
                        `${employee.firstName} ${employee.lastName}`.toLowerCase().includes(searchQuery) ||
                        employee.email.toLowerCase().includes(searchQuery) ||
                        employee.phoneNumber.toLowerCase().includes(searchQuery)
                    );
                });
            }

            // Render pagination controls
            function renderPagination(totalPages) {
                $('#pagination').empty();

                for (let i = 1; i <= totalPages; i++) {
                    $('#pagination').append(`<button class="pagination-button">${i}</button>`);
                }
            }

            // Fetch data when the page loads
            fetchData();

            // Attach event listeners
            // Sorting - Attach click event listener to column headers
            $('#employeeTable th').click(function() {
                const column = $(this).data('sort');

                if (currentSortColumn === column) {
                    isAscending = !isAscending;
                } else {
                    currentSortColumn = column;
                    isAscending = true;
                }

                renderTable();
            });

            // Searching - Attach input event listener to the search input field
            $('#searchInput').on('input', function() {
                renderTable();
            });

            // Pagination - Attach click event listeners to pagination controls
            $(document).on('click', '.pagination-button', function() {
                currentPage = parseInt($(this).text());
                renderTable();
            });
        });
    </script>
</body>
</html>
